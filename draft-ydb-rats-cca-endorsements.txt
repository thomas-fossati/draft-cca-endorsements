



RATS                                                        Y. Deshpande
Internet-Draft                                                   Arm Ltd
Intended status: Informational                                T. Fossati
Expires: 30 December 2024                                         Linaro
                                                            28 June 2024


Arm's Confidential Computing Architecture (Arm CCA) Attestation Verifier
                              Endorsements
                 draft-ydb-rats-cca-endorsements-latest

Abstract

   Arm Confidential Computing Architecture (Arm CCA) Endorsements
   comprise of reference values and cryptographic key material that a
   Verifier needs in order to appraise Attestation Evidence produced by
   Arm CCA system.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 30 December 2024.

Copyright Notice

   Copyright (c) 2024 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.  Code Components
   extracted from this document must include Revised BSD License text as
   described in Section 4.e of the Trust Legal Provisions and are
   provided without warranty as described in the Revised BSD License.



Deshpande & Fossati     Expires 30 December 2024                [Page 1]

Internet-Draft            Arm CCA Endorsements                 June 2024


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Conventions and Definitions . . . . . . . . . . . . . . . . .   2
   3.  Arm CCA Endorsements  . . . . . . . . . . . . . . . . . . . .   3
     3.1.  Arm CCA Platform Endorsements . . . . . . . . . . . . . .   3
       3.1.1.  Arm CCA Platform Endorsement Profile  . . . . . . . .   3
       3.1.2.  Arm CCA Platform Endorsements linkage to CCA
               Platform  . . . . . . . . . . . . . . . . . . . . . .   3
       3.1.3.  Reference Values  . . . . . . . . . . . . . . . . . .   4
       3.1.4.  Attestation Verification Claims . . . . . . . . . . .   5
     3.2.  Arm CCA Realm Endorsements  . . . . . . . . . . . . . . .   5
       3.2.1.  Realm Endorsements linkage to Realm . . . . . . . . .   6
       3.2.2.  Arm CCA Realm Endorsement Profile . . . . . . . . . .   6
       3.2.3.  Realm Reference Values  . . . . . . . . . . . . . . .   6
   4.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   6
     4.1.  CBOR Tag Registrations  . . . . . . . . . . . . . . . . .   6
     4.2.  CoRIM Profile Registration  . . . . . . . . . . . . . . .   7
     4.3.  CoMID Codepoints  . . . . . . . . . . . . . . . . . . . .   7
   Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . .   7
   References  . . . . . . . . . . . . . . . . . . . . . . . . . . .   7
     Normative References  . . . . . . . . . . . . . . . . . . . . .   8
     Informative References  . . . . . . . . . . . . . . . . . . . .   8
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   8

1.  Introduction

   Arm CCA Endorsements include reference values and cryptographic key
   material information that a Verifier needs in order to appraise
   attestation Evidence produced by a CCA System [CCA-TOKEN].  This memo
   defines such CCA Endorsements as a profile of the CoRIM data model
   [CoRIM].

2.  Conventions and Definitions

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

   The reader is assumed to be familiar with the terms defined in
   Section A7.2.1 of [CCA-TOKEN] and in Section 4 of [RATS-ARCH].








Deshpande & Fossati     Expires 30 December 2024                [Page 2]

Internet-Draft            Arm CCA Endorsements                 June 2024


3.  Arm CCA Endorsements

   Arm CCA attestation scheme is a composite attestation scheme which
   comprises a CCA Platform Attestation & a Realm Attestation.  Hence
   appraisal of Arm CCA attestation needs endorsements for both CCA
   Platform and CCA Realm.  This draft documents both the CCA platform
   and realm endorsements.

3.1.  Arm CCA Platform Endorsements

   There are three types of CCA Platform Endorsements:

   *  Reference Values (Section 3.1.3), i.e., measurements of the CCA
      Platform firmware.

   *  Attestation Verification Claims (Section 3.1.4), i.e.,
      cryptographic keys that can be used to verify signed attestation
      token produced by the CCA platform, along with the identifiers
      that bind the keys to their platform instances.

   *  Certification status of CCA platform implementation

3.1.1.  Arm CCA Platform Endorsement Profile

   Arm CCA platform Endorsements are carried in one or more CoMIDs
   inside a CoRIM.

   The profile attribute in the CoRIM MUST be present and MUST have a
   single entry set to the uri http://arm.com/cca/ssd/1 as shown in.

3.1.2.  Arm CCA Platform Endorsements linkage to CCA Platform

   Each CCA Platform Endorsement - be it a Reference Value, Attestation
   Verification Claim is associated with a unique CCA platform
   identifier.  A CCA platform identifier known as CCA Platform
   Implementation ID (see Section A7.2.3.2.3 of [CCA-TOKEN]) uniquely
   identifies a class of CCA platform to which the manufacturer/endorser
   links the supplied Endorsements (Reference Values & Attestation
   Verification Keys) for a CCA platform.

   In order to support CCA Implementation IDs, the CoMID type $class-id-
   type-choice is extended as follows:









Deshpande & Fossati     Expires 30 December 2024                [Page 3]

Internet-Draft            Arm CCA Endorsements                 June 2024


   Besides, a CCA Endorsement can be associated with a specific instance
   of a certain CCA Platform implementation - as in the case of
   Attestation Verification Claims.  A CCA Attestation Verification
   Claims are associated with a CCA platform instance by means of the
   Instance ID (see Section 3.2.1 of [CCA-TOKEN]) and its platform
   Implementation ID.

   These identifiers are typically found in the subject of a CoMID
   triple, encoded in an environment-map as shown in .

   Optional vendor and model can be specified as well.  Together, they
   are interpreted as a unique identifier of the product that embeds the
   CCA platform.  Consistently providing a product identifier is
   RECOMMENDED.

3.1.3.  Reference Values

   Reference Values carry measurements and other metadata associated
   with the CCA platform.  The CCA platform is a collective term used to
   identify all the hardware and firmware components on a CCCA enabled
   system.  This includes * CCA system security domain * Monitor
   security domain * Realm Management Security domain

   When appraising Evidence, the Verifier compares Reference Values
   against the values found in the Software Components of the CCA
   platform token (see Section 3.4.1 of [CCA-TOKEN]).

   Each measurement is encoded in a measurement-map of a CoMID
   reference-triple-record.  Since a measurement-map can encode one or
   more measurements, a single reference-triple-record can carry as many
   measurements as needed, provided they belong to the same CCA platform
   identified in the subject of the "reference value" triple.  A single
   reference-triple-record SHALL completely describe the CCA platform
   RoT.

   The identifier of a measured software component is encoded in a arm-
   swcomp-id object as follows:

   The semantics of the codepoints in the arm-swcomp-id map are
   equivalent to those in the arm-software-component map defined in
   Section 3.4.1 of [CCA-TOKEN].  The arm-swcomp-id MUST uniquely
   identify a given software component within the CCA platform /
   product.

   In order to support CCA Reference Value identifiers, the CoMID type
   $measured-element-type-choice is extended as follows:

   and automatically bound to the comid.mkey in the measurement-map.



Deshpande & Fossati     Expires 30 December 2024                [Page 4]

Internet-Draft            Arm CCA Endorsements                 June 2024


   The raw measurement is encoded in a digests-type object in the
   measurement-values-map.  The digests-type array MUST contain at least
   one entry.  The digests-type array MAY contain more than one entry if
   multiple digests (obtained with different hash algorithms) of the
   same measured component exist.

3.1.4.  Attestation Verification Claims

   An Attestation Verification Claim carries the verification key
   associated with the Initial Attestation Key (IAK) of a CCA platform.
   When appraising Evidence, the Verifier uses the Implementation ID and
   Instance ID claims (see Section 3.1.2) to retrieve the verification
   key that it SHALL use to check the signature on the CCA platform
   token.  This allows the Verifier to prove (or disprove) the
   Attester's claimed identity.

   Each verification key is provided alongside the corresponding device
   Instance and Implementation IDs (and, possibly, a product identifier)
   in an attest-key-triple-record.  Specifically:

   *  The Instance and Implementation IDs are encoded in the
      environment-map as shown in

   *  The IAK public key is carried in the comid.key entry in the
      verification-key-map.  The IAK public key is a PEM-encoded
      SubjectPublicKeyInfo [RFC5280].  There MUST be only one
      verification-key-map in an attest-key-triple-record;

   *  The optional comid.keychain entry MUST NOT be set by a CoMID
      producer that uses the profile described in this document, and
      MUST be ignored by a CoMID consumer that is parsing according to
      this profile.

   The example in shows the CCA Endorsement of type Attestation
   Verification Claim carrying a secp256r1 EC public IAK associated with
   Instance ID 4ca3...d296.

3.2.  Arm CCA Realm Endorsements

   Arm CCA Realm provides a protected execution environment for
   applications executing within a Realm.  A Realm Endorsements comprise
   of:

   *  Reference Values (Section 3.2.3), i.e., measurements of the
      configuration and contents of a Realm at the time of its
      activation along with measurements of software running inside
      Realm, which can be extended during the lifetime of a Realm.




Deshpande & Fossati     Expires 30 December 2024                [Page 5]

Internet-Draft            Arm CCA Endorsements                 June 2024


3.2.1.  Realm Endorsements linkage to Realm

   Each Realm has a unique execution context and hence a unique Realm
   instance.  Each Realm is uniquely identified in the Arm CCA system.
   For a realm its Endorsements are associated to this unique instance.
   The realm instance is be a vendor defined variable length identifier.
   Hence in this profile, it is represented in a CoMID inside an
   environment-map with $instance-id-type-choice set to tagged-bytes,
   i.e. An opaque, variable-length byte string.

   In order to support Realm Instance IDs, the CoMID type $instance-id-
   type-choice is extended as follows:

   A Vendor may wish to identify itself.  Hence the following optional
   elements in the environment-mapof a comid for the realm can be used.

   In the class-map select vendor name and/or class-id set as UUID
   representing unique identity for the Realm owner.

   $class-id-type-choice /= tagged-uuid-type

   vendor => tstr to represent vendor name

   Consistently providing a product identifier is RECOMMENDED.

3.2.2.  Arm CCA Realm Endorsement Profile

   Arm CCA realm Endorsements are carried in a CoMID inside a CoRIM.

   The profile attribute in the CoRIM MUST be present and MUST have a
   single entry set to the uri http://arm.com/cca/realm/1 as shown in.

3.2.3.  Realm Reference Values

   # Security Considerations


   // TODO

4.  IANA Considerations

4.1.  CBOR Tag Registrations

   IANA is requested to allocate the following tag in the "CBOR Tags"
   registry [IANA.cbor-tags], preferably with the specified value:






Deshpande & Fossati     Expires 30 December 2024                [Page 6]

Internet-Draft            Arm CCA Endorsements                 June 2024


        +=====+==============+===================================+
        | Tag | Data Item    | Semantics                         |
        +=====+==============+===================================+
        | 600 | tagged bytes | CCA Implementation ID             |
        |     |              | (Section 3.1.2 of RFCTHIS)        |
        +-----+--------------+-----------------------------------+
        | 601 | tagged map   | CCA Software Component Identifier |
        |     |              | (Section 3.1.3 of RFCTHIS)        |
        +-----+--------------+-----------------------------------+

                         Table 1: CoRIM CBOR Tags

4.2.  CoRIM Profile Registration

   IANA is requested to register the following profile value in the
   // TODO CoRIM registry.

     +==========================+======+============================+
     | Profile Value            | Type | Semantics                  |
     +==========================+======+============================+
     | http://arm.com/cca/ssd/1 | uri  | The CoRIM profile          |
     |                          |      | specified by this document |
     +--------------------------+------+----------------------------+

                      Table 2: PSA profile for CoRIM

4.3.  CoMID Codepoints

   IANA is requested to register the following codepoints to the "CoMID
   Triples Map" registry.

            +=======+=========================+===============+
            | Index | Item Name               | Specification |
            +=======+=========================+===============+
            | 4     | comid.psa-cert-triples  | RFCTHIS       |
            +-------+-------------------------+---------------+
            | 5     | comid.psa-swrel-triples | RFCTHIS       |
            +-------+-------------------------+---------------+

                         Table 3: PSA CoMID Triples

Acknowledgements


   // TODO

References




Deshpande & Fossati     Expires 30 December 2024                [Page 7]

Internet-Draft            Arm CCA Endorsements                 June 2024


Normative References

   [CoRIM]    Birkholz, H., Fossati, T., Deshpande, Y., Smith, N., and
              W. Pan, "Concise Reference Integrity Manifest", Work in
              Progress, Internet-Draft, draft-ietf-rats-corim-04, 4
              March 2024, <https://datatracker.ietf.org/doc/html/draft-
              ietf-rats-corim-04>.

   [IANA.cbor-tags]
              IANA, "Concise Binary Object Representation (CBOR) Tags",
              <https://www.iana.org/assignments/cbor-tags>.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/rfc/rfc2119>.

   [RFC5280]  Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,
              Housley, R., and W. Polk, "Internet X.509 Public Key
              Infrastructure Certificate and Certificate Revocation List
              (CRL) Profile", RFC 5280, DOI 10.17487/RFC5280, May 2008,
              <https://www.rfc-editor.org/rfc/rfc5280>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/rfc/rfc8174>.

Informative References

   [CCA-TOKEN]
              "Realm Management Monitor specification", 2022,
              <https://documentation-service.arm.com/
              static/63a16f163f28e5456434c719?token=>.

   [RATS-ARCH]
              Birkholz, H., Thaler, D., Richardson, M., Smith, N., and
              W. Pan, "Remote ATtestation procedureS (RATS)
              Architecture", RFC 9334, DOI 10.17487/RFC9334, January
              2023, <https://www.rfc-editor.org/rfc/rfc9334>.

Authors' Addresses

   Yogesh Deshpande
   Arm Ltd
   Email: yogesh.deshpande@arm.com






Deshpande & Fossati     Expires 30 December 2024                [Page 8]

Internet-Draft            Arm CCA Endorsements                 June 2024


   Thomas Fossati
   Linaro
   Email: thomas.fossati@linaro.org
















































Deshpande & Fossati     Expires 30 December 2024                [Page 9]
